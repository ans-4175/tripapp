<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>HOP</title>
  <link rel="stylesheet" href="themes/koko2.min.css" />
  <link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.4.3.min.css" />
  <!--link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.2.min.css" /-->
  <link rel="stylesheet" type="text/css" href="css/index.css" />
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  <link rel="stylesheet" type="text/css" href="css/font/typo.css" />
  <link rel="stylesheet" type="text/css" href="css/responsive.css">
  <script src="js/modernizr.custom.js"></script>
    <!--[if lt IE 9]>

    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

<div data-role="page">
  <div data-role="panel" id="myPanel" data-display="push"> > 
  </div> 

	<div data-role="header" data-position="fixed" data-tap-toggle="false">
   		<div class="headpage">
      		<div><a href="#myPanel"><img class="side_menu" src="img/side_menu_btn.png"></a></div>
      		<div class="browse_text">Create Trip</div>
    	</div><!-- /header -->
  </div>

	<div role="main" id="view-content">
      <!--********************** pop up  *******************************************************-->
        <div data-role="popup" id="popupJudul">
             <input type="text" name="text-2" id="text-judul" onchange="gantiJudul('text-judul','judulRoute','add title...','judul')" value="" placeholder="judul"  data-enhanced="true">
        </div>

        <div data-role="popup" id="popupCat">
          <form>
            <fieldset data-role="controlgroup" id="listgrup">
              <input data-iconpos="right" type="checkbox" name="edu" id="checkbox-v-2a" >
              <label for="checkbox-v-2a"><img src="img/cat_educational.png">Educational</label>
              <input data-iconpos="right "type="checkbox" name="culi" id="checkbox-v-2b">
              <label for="checkbox-v-2b"><img src="img/cat_culinary.png">Culinary</label>
              <input type="checkbox" name="cult" id="checkbox-v-2c" data-iconpos="right" >
              <label for="checkbox-v-2c"><img src="img/cat_culture.png">Culture</label>
              <input data-iconpos="right "type="checkbox" name="eco" id="checkbox-v-2d">
              <label for="checkbox-v-2d"><img src="img/cat_economical.png">Economical</label>
              <input data-iconpos="right "type="checkbox" name="fam" id="checkbox-v-2e" >
              <label for="checkbox-v-2e"><img src="img/cat_family.png">Family</label>
              <input data-iconpos="right" type="checkbox" name="his" id="checkbox-v-2f">
              <label for="checkbox-v-2f"><img src="img/cat_history.png">History</label>
              <input data-iconpos="right "type="checkbox" name="nat" id="checkbox-v-2g">
              <label for="checkbox-v-2g"><img src="img/cat_nature.png">Nature</label>
              <input data-iconpos="right "type="checkbox" name="rom" id="checkbox-v-2h">
              <label for="checkbox-v-2h"><img src="img/cat_romantic.png">Romantic</label>
              <div class="tombolPopup"><a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-a lebar50" data-rel="back">Cancel</a><a href="#" onclick="cebok('listgrup','tagsRoute')" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-a lebar50" data-rel="back">Done</a>
              </div>
            </fieldset>
          </form>
        </div>

        <div data-role="popup" id="popupBring">
          <form>
            <fieldset data-role="controlgroup" id="listgrup2">
              <input data-iconpos="right "type="checkbox" name="cash" id="checkbox-v-2i" data-mini="true">
              <label for="checkbox-v-2i"><img  src="img/bring_cash.png">Cash</label>
              <input data-iconpos="right "type="checkbox" name="camera" id="checkbox-v-2j" data-mini="true">
              <label for="checkbox-v-2j"><img  src="img/bring_camera.png">Camera</label>
              <input type="checkbox" name="food" id="checkbox-v-2k" data-iconpos="right" data-mini="true">
              <label for="checkbox-v-2k"><img  src="img/bring_food.png">Food</label>
              <input data-iconpos="right "type="checkbox" name="nohigh" id="checkbox-v-2l" data-mini="true">
              <label for="checkbox-v-2l"><img  src="img/bring_high_heels.png">No High Heels</label>
              <input data-iconpos="right "type="checkbox" name="picnic" id="checkbox-v-2m" data-mini="true">
              <label for="checkbox-v-2m"><img  src="img/bring_picnic_mat.png">Picnic Mat</label>
              <input type="checkbox" name="wat" id="checkbox-v-2n" data-iconpos="right" data-mini="true">
              <label for="checkbox-v-2n"><img  src="img/bring_water.png">Water</label>
            </fieldset>
          </form>
               <div class="tombolPopup"><a href="#" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Cancel</a>
                <a href="#" onclick="cebokbring('listgrup2','bringsRoute')" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Done</a></div>
        </div> 

        <div data-role="popup" id="popupJam">
          <div class="waktu_mulai text_cen margin_top_bot"><img src="img/time.png"><span class="mulai_text">start time</span></div>
          <div class="waktu_mulai_form text_cen">
            <form>
              <input class="lebar50" type="text" name="jamStart" id="jamStart" value="" placeholder="18"  data-enhanced="true">
              <input class="lebar50" type="text" name="menitStart" id="menitStart" value="" placeholder="59"  data-enhanced="true">
            </form>
          </div>
          <div class="waktu_akhir text_cen margin_top_bot"><img src="img/time.png"><span class="end_text">end time</span></div>
          <div class="waktu_end_form text_cen">
              <form>
                <input class="lebar50" type="text" name="jamEnd" id="jamEnd" value="" placeholder="18"  data-enhanced="true">
                <input class="lebar50" type="text" name="menitEnd" id="menitEnd" value="" placeholder="59"  data-enhanced="true">
              </form>
          </div>
          <div class="tombolPopup"><a href="#" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Cancel</a><a href="#" onclick="gantiJam()" value="" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Done</a>
          </div>
        </div> 

      <div data-role="popup" id="popupTiket">
              <div class="text_cen margin_top_bot imgtiket"><img src="img/ticket.png">ticket</div>
              <div><form class="text_cen">Rp.<input class="lebar50" type="text" name="hargaTiket" id="hargaTiket" value="" placeholder="10000"  data-enhanced="true"></form></div>
              <div class="text_cen margin_top_bot imgfood"><img src="img/food_bev.png">food &amp; bev</div>
              <div><form class="text_cen">Rp.<input class="lebar50" type="text" name="hargaFood" id="hargaFood" value="" placeholder="10000"  data-enhanced="true"></form></div>
              <!--<div><img src="img/rent.png"> rent</div>
              <div><form>Rp.<input class="lebar50" type="text" name="hargaRent" id="hargaRent" value="" placeholder="18"  data-enhanced="true"></form></div>-->
              <div class="tombolPopup"><a href="#" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Cancel</a>
              <a href="#" onclick="gantiBiaya()" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Done</a></div>
      </div> 

        <div data-role="popup" id="popupket">
            <form>
                <textarea value="" name="textarea-6" placeholder="isilah keterangan" data-enhanced="true" id="ket2"></textarea>
            </form>
            <div class="tombolPopup"><a href="#" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Cancel</a><a href="#" onclick="gantiJudul('ket2','ketRoute','keterangan ...','ket')" class="ui-btn ui-corner-all ui-btn-inline ui-btn-a lebar50" data-rel="back">Done</a>
            </div>
        </div>
      <!-- gambar utama & deskripsi -->
   		<div class='view1' id="picRoute">
        <div class="judul_view"><a style="color:white;" href="#popupJudul" data-rel="popup" data-transition="pop"><span id="judulRoute">Add title ...</span></a></div>
        <div class="add_pic"><a style="color:#ffffff !important;" onclick="clickFile()" href="">ADD<br />MAIN PICTURE</a></div>
        <div class="cat_img"><a style="color:#ffffff !important;" href="#popupCat" data-rel="popup" data-transition="pop"><span id="tagsRoute">add tags ...</span></a></div> 
        <div class="map_img"><a href="" onclick="alert('peta belum tersedia')"><img class="img_btn" src="img/map_btn.png" /></a></div>
        <div class="gal_img"><a href="" onclick="clickFile()" ><img class="img_btn" src="img/gallery_btn.png" /></a></div>
        <div class="cam_img"><a href="" onclick="clickFile()"><img class="img_btn" src="img/camera_circ-btn.png" /></a></div>
      </div>
        <div id="text_desc"><a style="color:#000 !important;" href="#popupket" data-rel="popup" data-transition="pop">
          <p><span id="ketRoute">Keterangan</span></p></a>
          <div class="ui-input-hide"><input type="file" id="take-picture" accept="image/*;" onchange="loadImageFileAsURL()"></div>
        </div>

        <div class="separator"></div>

        <div class="rwd2">
        <a style="color:#000 !important;" href="#popupJam">
        <!--a style="color:#000 !important;" href="#popupJam" data-rel="popup" data-transition="pop"-->
          <div class="ui-block-a"><img src="img/time.png"></div>
          <div class="ui-block-b"><div class="stat_text"><span class="dina_text" id="dina_jam">24</span>h</div></div>
          <div class="ui-block-c"><div class="stat_text"><span class="dina_text" id="dina_men">0</span>m</div></div>
          <div class="ui-block-d"></div>
          <div class="ui-block-e"><div class="stat_text"><span class="dina_text" id="jamStart2">00</span>.<span class="dina_text" id="menitStart2">00</span>-<span class="dina_text" id="jamEnd2">00</span>.<span class="dina_text" id="menitEnd2">00</span></div></div>
          <div style="clear:both"></div>
          </a>
        </div><!-- grid jam -->

        <div class="rwd3">
        <!--a style="color:#000 !important;" href="#popupTiket" data-rel="popup" data-transition="pop"-->
        <a style="color:#000 !important;" href="#popupTiket">
          <div class="ui-block-a"><img src="img/ticket.png"></div>
          <div class="ui-block-b"><div class="stat_text">Rp.<span class="dina_text" id="hargaTiket2">0</span></div></div>
          <div class="ui-block-c"></div>
          <div class="ui-block-d"><img src="img/food_bev.png"></div>
          <div class="ui-block-e"><div class="stat_text">Rp.<span class="dina_text" id="hargaFood2">0</span></div></div>
          <div style="clear:both"></div>
          </a>
        </div><!-- grid harga -->

        <div class="separator"></div>

        <div class="rwd7">
          <div class="popbring"><a style="color:#000 !important;" href="#popupBring" data-rel="popup" data-transition="pop"><span id="bringsRoute">&nbsp;&nbsp;&nbsp;add bringings ...</span></a></div>
        </span>
        <div style="clear:both"></div>
        </div>
      <!--********************** akhir gambar utama & deskripsi  *******************************************************-->
      <!-- start list tempat -->
        <div>
          <ul data-role="listview" data-icon="false" id="content_places">
            
          </ul>
        </div>
        <!-- akhir list tempat -->
  </div>

	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<div data-role="navbar">
        <ul>
            <li id="btnAddPlace" class="img_nav"><a href="#" onclick="pindahAddplace()" data-icon="false">&#43; ADD PLACE</a></li>
            <li id="btnFinish" class="img_nav"><a href="#" onclick="finishCreate()" data-icon="false">FINISH<span style="display:none" id='loading'> (loading to upload)</span></a></li>
        </ul>
    	</div><!-- /navbar -->

	</div><!-- /footer -->
    
    <script src="js/jquery-1.11.1.min.js"></script>
    <script src="js/functions.js"></script>
    <script src="js/classie.js"></script>
    <script type="text/javascript" src="js/fastclick.js"></script>
    <script src="js/jquery.mobile-1.4.3.min.js"></script>
    <script type="text/javascript">
      window.onload = function() {
        $('#myPanel').load('comp_sidelink.html');
        if (localStorage.getItem("logged") === null) {
          pindahHal('login');
        }
        if (localStorage.getItem("createRoute") !== null) {
          //ambil data
          var totiket = 0;
          var totmakan = 0;
          new FastClick(document.body);
          var createR = JSON.parse(localStorage.getItem('createRoute'));
          console.log(createR);
          //places
          for (var place in createR.places){
            addPlaces(place);
            //change isi
            $('#judulTempat-'+place).html(createR.places[place].judul);
            $('#ket_tempat-'+place).html(createR.places[place].ket);
            //jam
            $('#jamStart2_tempat-'+place).html(createR.places[place].jamSt);
            $('#menitStart2_tempat-'+place).html(createR.places[place].menitSt);
            $('#jamEnd2_tempat-'+place).html(createR.places[place].jamEnd);
            $('#menitEnd2_tempat-'+place).html(createR.places[place].menitEnd);
            gantiDurasi(createR.places[place].jamSt,createR.places[place].menitSt,createR.places[place].jamEnd,createR.places[place].menitEnd,place);
            //tiket
            $('#hargaTiket2_tempat-'+place).html(int_to_rp(createR.places[place].tiket));
            $('#hargaFood2_tempat-'+place).html(int_to_rp(createR.places[place].makan));
            //hitung total tiket-makan
            totiket += parseInt(createR.places[place].tiket);
            totmakan += parseInt(createR.places[place].makan);
            //pic
            if (createR.places[place].pic){
              $('#picPlace-'+place).css('background-image', 'url('+createR.places[place].pic+')');
            }else{
              $('#picPlace-'+place).css('background-image', 'url(img/default-background.png)');
            }
          }
          $('#judulRoute').html(createR.judul);
          if (createR.tags.length > 0)
            genTags(createR.tags,'tagsRoute');
          else
            $('#tagsRoute').html('add tags...');  
          if (createR.brings.length > 0)
            genBrings(createR.brings,'bringsRoute');
          else
            $('#tagsRoute').html('add tags...');
          $('#ketRoute').html(createR.ket);
          //jam
          if (createR.places.length >= 1){
            $('#jamStart2').html(createR.places[0].jamSt);
            $('#menitStart2').html(createR.places[0].menitSt);
            $('#jamEnd2').html(createR.places[place].jamEnd);
            $('#menitEnd2').html(createR.places[place].menitEnd);
            gantiDurasi(createR.places[0].jamSt,createR.places[0].menitSt,createR.places[place].jamEnd,createR.places[place].menitEnd);
            createR['jamSt'] = createR.places[0].jamSt;
            createR['menitSt'] = createR.places[0].menitSt;
            createR['jamEnd'] = createR.places[place].jamEnd;
            createR['menitEnd'] = createR.places[place].menitEnd;
          }
          //tiket
          $('#hargaTiket2').html(int_to_rp(totiket));
          $('#hargaFood2').html(int_to_rp(totmakan));
          createR['tiket'] = totiket;
          createR['makan'] = totmakan;
          //pic
          if (createR['pic']){
            $('#picRoute').css('background-image', 'url('+createR['pic']+')');
          }else{
            $('#picRoute').css('background-image', 'url(img/default-background.png)');
          }
          //simpan
          localStorage.setItem('createRoute', JSON.stringify(createR));  
        }else{
          //new initialize
          var createR = new Object();
          var vuserid = JSON.parse(localStorage.getItem('logged'));
          createR['id'] = vuserid.id;
          createR['judul'] = 'add title...';
          createR['ket'] = 'keterangan...';
          createR['tags'] = [];
          createR['pic'] = '';
          createR['jamSt'] = '00';
          createR['menitSt'] = '00';
          createR['jamEnd'] = '00';
          createR['menitEnd'] = '00';
          createR['tiket'] = 0;
          createR['makan'] = 0;
          createR['brings'] = [];
          createR['places'] = [];
          localStorage.setItem('createRoute', JSON.stringify(createR));  
        }
      };
      function finishCreate(){
        var createR = JSON.parse(localStorage.getItem('createRoute'));
        //save
        $('#loading').show();
        $.post("http://labtekindie.net/trippp/trip/make/"+createR.id, { tripadd:JSON.stringify(createR) }, function( data ) {
            var resp = JSON.parse(data);
            console.log(resp.response);
            //hapus
            localStorage.removeItem('createRoute');
            //pindah
            alert('Trip has been saved');
            pindahHal('browse');
        }, "json");
      }
      function clickFile(){
        //$('#take-picture').click();
        $('#take-picture').trigger('click');
        return false;
      }
    </script>
</div><!-- /page -->

</body>
</html>
